# 1.1 https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MCD12Q1
IGBPnames_006 <- c(
        "UNC", "ENF", "EBF", "DNF", "DBF", "MF", # 5 types
        "CSH", "OSH", "WSA", "SAV", "GRA", "WET",
        "CRO", "URB", "CNV", "SNO", "BSV", "water"
) # 1:17
IGBPcodes_006 <- setNames(0:17, IGBPnames_006)

# 1.2 https://developers.google.com/earth-engine/datasets/catalog/MODIS_051_MCD12Q1
IGBPnames_005 <- c(
        "water", # 0
        "ENF", "EBF", "DNF", "DBF", "MF",
        "CSH", "OSH", "WSA", "SAV", "GRA", "WET",
        "CRO", "URB", "CNV", "SNO", "BSV", "UNC"
) # 0:16, 254
IGBPcodes_005 <- setNames(c(0:16, 254), IGBPnames_005)

# ;;;Initial parameter values for IGBP land cover classifications
# Maximun stomatal conductance in ms, make sure GaGc~0
gsx_raw = c(50.00, 3.2, 3.8, 3.2, 4.3, 3.1,
        2.4, 2.4, 1.9, 3.7, 2.3, 16.3,
        5.2, 5.00, 5.2, 50.00, 0.50, 4.00);
# canopy height
hc_raw = c(0.01, 10., 10., 10., 10., 10.,
        1.00, 1.00, 5.00, 5.00, 0.2, 1.00,
        0.5, 10., 1.0, 0.01, 0.05, 0.01);

# 这个版本的参数，是Zhang2019,RSE文章的参数，LAI为combined LAI。
# note that MCD12Q1.005 IGBPcode begins from 
Alpha_raw = c(0.000, 0.041, 0.048, 0.041, 0.029, 0.029,
        0.029, 0.029, 0.044, 0.029, 0.034, 0.026,
        0.029, 0.029, 0.029, 0.000, 0.034, 0.000);
Theta_raw = c(0.000, 0.069, 0.024, 0.069, 0.022, 0.036,
        0.063, 0.063, 0.035, 0.036, 0.027, 0.038,
        0.069, 0.036, 0.069, 0.000, 0.027, 0.000);
m_raw = c(0.000, 8.316, 10.602, 8.316, 10.930, 8.539,
        6.320, 6.320, 6.500, 9.031, 6.250, 25.755,
        8.404, 8.539, 8.404, 0.000, 6.250, 0.000);
Am_25_raw = c(0.000, 13.133, 13.875, 13.133, 10.805, 15.930,
        12.812, 12.812, 13.000, 15.809, 46.375, 16.070,
        20.181, 15.930, 20.181, 0.000, 46.375, 0.000);
D0_raw = c(0.700, 0.501, 0.536, 0.501, 0.552, 0.501,
        0.575, 0.575, 0.747, 0.809, 0.544, 2.000,
        0.696, 0.501, 0.696, 0.700, 0.544, 0.700);
kQ_raw = c(0.600, 0.914, 0.832, 0.914, 0.480, 0.593,
        0.691, 0.691, 0.753, 1.000, 0.722, 0.644,
        0.100, 0.593, 0.100, 0.600, 0.722, 0.600);
kA_raw = c(0.700, 0.899, 0.899, 0.899, 0.895, 0.680,
        0.895, 0.895, 0.848, 0.895, 0.895, 0.899,
        0.899, 0.680, 0.899, 0.700, 0.895, 0.700);
S_sls_raw = c(0.000, 0.123, 0.098, 0.123, 0.069, 0.131,
        0.014, 0.014, 0.174, 0.049, 0.114, 0.010,
        0.010, 0.131, 0.010, 0.000, 0.114, 0.000);
fER0_raw = c(0.010, 0.055, 0.085, 0.055, 0.010, 0.010,
        0.010, 0.010, 0.109, 0.055, 0.023, 0.010,
        0.158, 0.010, 0.158, 0.000, 0.023, 0.000);
VPDmin_raw = c(1.000, 0.657, 0.664, 0.657, 0.664, 0.657,
        1.492, 1.492, 0.664, 1.032, 0.664, 1.399,
        1.213, 0.657, 1.213, 1.000, 0.664, 1.000);
VPDmax_raw = c(4.000, 6.203, 4.570, 6.203, 6.305, 3.500,
        4.086, 4.086, 3.938, 3.695, 3.625, 6.500,
        3.500, 3.500, 3.500, 4.000, 3.625, 4.000);
# ;;not real values for LAIref currently
LAIref_raw = c(5.000, 5.000, 5.000, 5.000, 5.000, 5.000,
        5.000, 5.000, 5.000, 5.000, 5.000, 5.000,
        5.000, 5.000, 5.000, 5.000, 5.000, 5.000);


# parnames   = {'Alpha', 'Thelta', 'm', 'Am', 'D0', 'kQ', 'kA', 'S_sls', 'fER0', 'VPDmin','VPDmax','LAIref', 'frame'}; %
# % 'PPmin', 'PPmax'
# lb         = [0.01   0.01   2    5    0.5  0.1     0.5  1e-2 1e-2  , 0.65  , 3.5, 1, 6];  %, 1
# ub         = [0.10   0.07   100  120  2.0  1       0.9  1    0.5     , 1.5   , 6.5, 6, 14];   %, 10
# PARAMETERS = [0.06   0.04   10    50  0.7  0.4488  0.7  0.1  0.1 , 0.93  , 4 , 4, 10]; %, 5

#' PML parameter boundaries
#' @export
param0_PML = tibble::tribble(
    ~Id, ~name, ~lb, ~ub, ~par,
    1, "Alpha"  , 0.01, 0.10, 0.06,
    2, "Thelta" , 0.01, 0.07, 0.04,
    3, "m"      , 2   , 100 , 10,
    4, "Am_25"  , 5   , 120 , 50, 
    5, "D0"     , 0.5 , 2.0 , 0.7, 
    6, "kQ"     , 0.1 , 1   , 0.45,
    7, "kA"     , 0.5 , 0.9 , 0.7,
    8, "S_sls"  , 1e-2, 1   , 0.1,
    9, "fER0"   , 1e-2, 0.5 , 0.1, 
    10, "VPDmin", 0.65, 1.5 , 0.9, # kPa
    11, "VPDmax", 3.5 , 6.5 , 4,   # kPa
    # 12, "LAIref", 1   , 6   , 4,   # -
    # 13, "frame" , 6   , 14  , 10   # 8-day
)
